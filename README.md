# 🤖  Телеграм-бот для мониторинга давления [BOT_OLA_AD]

Телеграм-бот на Python, предназначенный для сбора данных мониторинга артериального давления, пульса и комментариев. Бот поддерживает регистрацию, просмотр истории, построение графиков и экспорт данных. Проект легко разворачивается с помощью Docker, использует SQLite и имеет автоматическую инициализацию и резервное копирование.

---

1. [Описание функционала](#🧠-описание-функционала)
2. [Технологии](#🧪-технологии)
3. [Быстрый старт](#🚀-быстрый-старт)
4. [Структура проекта](#🧩-структура-проекта)
5. [Makefile-команды](#🛠-команды-makefile)
6. [Описание версий](#🧾-описание-версий)
7. [Обратная связь](#📬-обратная-связь)

---

## 🧠 Описание функционала

Бот предоставляет следующие возможности:

- **Регистрация пользователей**:
  - Пользователи регистрируются через Telegram, отправляя свой номер телефона.
  
- **Добавление записей**:
  - Пользователь может добавить запись с верхним и нижним давлением, пульсом и комментарием.

- **Просмотр последних записей**:
  - Бот выводит последние 10 записей пользователя.

- **График давления и пульса**:
  - Строится график динамики давления и пульса за всё время.

- **Экспорт данных**:
  - Данные можно экспортировать в файл Excel или CSV.

- **Бэкап базы данных**:
  - Команда `/backup` позволяет получить `.db` файл SQLite.

- **Выход из аккаунта**:
  - Пользователь может выйти из системы.

- **Панель администратора**:
  - Команды `/backup`, `/export_csv`, `/send_last_records` доступны только администраторам.


---

## ⚙️ Технологии

- ✅ Обработка команд Telegram через `aiogram`
- 🗂 Автоматическое создание базы данных SQLite при первом запуске
- 🧠 Хранение пользователей и измерений давления (`ad_users`, `ad_pressure_measurements`)
- 📤 Отправка резервной копии `.db` файла по команде `/backup`
- 📦 Упаковано в Docker-контейнер
- 🛠 Удобное управление через `Makefile`

---

## 🚀 Быстрый старт

### 📦 1. Клонировать проект

```bash
git clone https://github.com/yourusername/BOT_OLA_AD.git
cd BOT_OLA_AD
```

### 🔐 2. Создать файл .env

В корне проекта:

```env
BOT_TOKEN=твой_телеграм_токен
```

### 🧱 3. Установить make и Docker (если не установлен)

```bash
sudo apt update
sudo apt install make docker docker-compose -y
```

### 🐳 4. Сборка и запуск

```bash
make build     # Собрать контейнер
make up        # Запустить бота в фоне
make logs      # Смотреть логи
```

---

## 🧩 Структура проекта

```bash
BOT_OLA_AD/
├── backups/                  # Бэкапы БД
├── check/                    # Скрипты инициализации
│   └── check_exists_db.py
├── database/                 # Файл SQLite базы (монтируется в контейнер)
├── logs/                     # Логи, включая init.log
├── main.py                   # Основной код бота
├── config.py                 # Конфигурация Telegram и переменных окружения
├── db_config.py              # Конфигурация пути к SQLite базе
├── Dockerfile
├── docker-compose.yml
├── requirements.txt
├── .env                      # Телеграм-токен (не коммитить (0_^) )
├── .gitignore
└── Makefile
```

---

## 🛠 Makefile-команды

| -------------- | ---------------------------------------- |
| Команда        | Описание                                 |
| -------------- | ---------------------------------------- |
| `make build`   | Сборка Docker-образа                     |
| `make up`      | Запуск контейнера в фоне                 |
| `make logs`    | Просмотр логов                           |
| `make restart` | Перезапуск                               |
| `make down`    | Остановка и удаление контейнера          |
| `make clean`   | Полная очистка: контейнеры, образы, тома |
| `make shell`   | Вход внутрь контейнера (bash)            |
| `make backup`  | Создание резервной копии                 |
| `make restore` | Восстановление резервной копии           |
| -------------- | ---------------------------------------- |

---

## Описание версий

### Версия 1.0.0
Базовая регистрация, записи, графики, экспорт в Excel

### Версия 1.1.0
Экспорт в CSV, улучшения меню, оптимизация БД

### Версия 1.1.1
Обработка ошибок, багфиксы графиков, кастомное меню

### Версия 1.2.0
Стаблиьная версия

---

## 📬 Обратная связь
Проект разработан @aldabaeva
Вопросы и предложения — Telegram: @skiperkrut
Почта: personal@aldabaeva.com